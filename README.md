# Генератор QR-кодов

Простое веб-приложение, которое генерирует QR-коды по URL и выводит их в виде PDF-файлов формата A4. В приложении реализована валидация на стороне клиента и на стороне сервера, что гарантирует обработку только корректных URL. Также поддерживается функция загрузки файлов различных форматов с получением общедоступной ссылки.

## Обзор проекта

Этот проект представляет собой PHP-приложение для генерации QR-кодов, позволяющее пользователям создавать QR-коды по URL и скачивать их в виде PDF-файлов. Для генерации QR-кодов используется библиотека Endroid QR Code, а для создания PDF-документов с встраиванием QR-кодов и пользовательских шрифтов — TCPDF. Приложение имеет простой и интуитивно понятный интерфейс с двумя основными функциями: генерация QR-кода по ссылке и загрузка файла с получением общедоступной ссылки.

## Возможности

* Генерация QR-кодов из URL
* Загрузка файлов (PNG, JPG, JPEG, PDF, PPT, PPTX, DOC, DOCX) и получение общей ссылки
* Добавление заголовка к QR-коду
* Скачивание результата в формате PDF A4
* Валидация на стороне клиента и на стороне сервера
* Адаптивный дизайн
* Встраивание шрифта Times New Roman в PDF

## Требования

* PHP версии 8.3 или выше
* Расширение PHP mbstring
* Composer
* Веб-сервер (Apache, Nginx и т.д.)
* Права на запись в директориях `qrcodes` и `uploads`

## Установка

1. Клонируйте этот репозиторий в директорию вашего веб-сервера:

   ```bash
   git clone https://github.com/yourusername/qr-generator.git
   ```

2. Перейдите в каталог проекта:

   ```bash
   cd qr-generator
   ```

3. Установите зависимости через Composer (обязательно):

   ```bash
   composer install
   ```

   **Важно**: приложение не будет работать без установленных зависимостей. Если вы видите ошибку об отсутствии `vendor/autoload.php`, значит нужно выполнить эту команду.

4. Убедитесь, что директории `qrcodes` и `uploads` доступны для записи веб-серверу:

   ```bash
   sudo mkdir qrcodes uploads
   sudo chown www-data:www-data qrcodes uploads
   sudo chmod 755 qrcodes uploads
   ```

5. Убедитесь, что существует директория `fonts` и в ней находятся необходимые файлы шрифтов:

   ```bash
   ls -la fonts       # Проверка наличия директории
   sudo mkdir -p fonts  # Создание, если отсутствует
   ```

6. Настройте веб-сервер для обслуживания приложения. В репозитории есть пример конфигурации Nginx (`nginx.conf`), который можно использовать как шаблон:

   ```bash
   sudo cp nginx.conf /etc/nginx/sites-available/qr-generator.conf
   sudo ln -s /etc/nginx/sites-available/qr-generator.conf /etc/nginx/sites-enabled/
   sudo nginx -t
   sudo nginx -s reload
   ```

## Использование

### Для генерации QR-кода

1. Откройте приложение в браузере.
2. В поле «Название QR-кода» введите заголовок.
3. Перейдите на вкладку «Ссылка».
4. В поле «Ссылка на QR-код» введите нужный URL.
5. Нажмите «Сгенерировать QR-код» для создания и скачивания PDF.
6. PDF автоматически загрузится с QR-кодом, центрированным на странице A4.

### Для загрузки файла

1. Откройте приложение в браузере.
2. В поле «Название QR-кода» введите заголовок.
3. Перейдите на вкладку «Файл».
4. Нажмите на область загрузки и выберите файл (поддерживаемые форматы: PNG, JPG, JPEG, PDF, PPT, PPTX, DOC, DOCX).
5. Нажмите «Сгенерировать QR-код» для загрузки файла.
6. После успешной загрузки вы получите общедоступную ссылку на файл.

## Тестирование

В проекте есть скрипт `test.php`, который проверяет правильность настройки окружения:

```bash
php test.php
```

Скрипт проверяет:

* Совместимость версии PHP
* Наличие необходимых директорий
* Установку зависимостей Composer
* Функциональность генерации QR-кода

Запустите его после установки, чтобы убедиться, что всё работает корректно.

## Принцип работы

### Генерация QR-кода

1. Пользователь вводит заголовок и URL в форму.
2. JavaScript на стороне клиента в реальном времени проверяет корректность URL.
3. При отправке формы JavaScript предотвращает стандартную отправку и обрабатывает её через скрытый iframe для удобства скачивания.
4. На сервере повторно проверяются данные: обязательные поля и формат URL.
5. С помощью библиотеки endroid/qr-code генерируется QR-код и сохраняется временный PNG-файл.
6. QR-код вставляется в PDF-документ при помощи TCPDF, заголовок выводится шрифтом Times New Roman.
7. PDF отправляется пользователю для скачивания с уникальным именем на основе метки времени.
8. Временные PNG-файлы удаляются после генерации PDF.

### Загрузка файла

1. Пользователь вводит заголовок и выбирает файл.
2. При отправке формы файл передаётся на сервер.
3. Сервер проверяет тип файла на соответствие поддерживаемым форматам.
4. Файл сохраняется в структуре директорий по дате (год/месяц/день).
5. Формируется уникальное имя на основе заголовка, метки времени и оригинального имени файла.
6. Сервер возвращает общедоступную ссылку на загруженный файл.
7. Ссылка отображается пользователю для копирования и дальнейшего использования.

## Лицензия

Проект распространяется под лицензией MIT — подробности в файле LICENSE.

## Благодарности

* [TCPDF](https://github.com/tecnickcom/TCPDF) — за генерацию PDF с встраиванием шрифтов
* [endroid/qr-code](https://github.com/endroid/qr-code) — за генерацию QR-кодов
